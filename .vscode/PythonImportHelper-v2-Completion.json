[
    {
        "label": "json",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "json",
        "description": "json",
        "detail": "json",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "shutil",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "shutil",
        "description": "shutil",
        "detail": "shutil",
        "documentation": {}
    },
    {
        "label": "sqlite3",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sqlite3",
        "description": "sqlite3",
        "detail": "sqlite3",
        "documentation": {}
    },
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "hashlib",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "hashlib",
        "description": "hashlib",
        "detail": "hashlib",
        "documentation": {}
    },
    {
        "label": "Optional",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "platform",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "platform",
        "description": "platform",
        "detail": "platform",
        "documentation": {}
    },
    {
        "label": "database.db",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "database.db",
        "description": "database.db",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "create_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "get_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "delete_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "get_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "verify_password",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "update_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "get_account",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "verify_password",
        "importPath": "database.db",
        "description": "database.db",
        "isExtraImport": true,
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "Console",
        "importPath": "rich.console",
        "description": "rich.console",
        "isExtraImport": true,
        "detail": "rich.console",
        "documentation": {}
    },
    {
        "label": "Console",
        "importPath": "rich.console",
        "description": "rich.console",
        "isExtraImport": true,
        "detail": "rich.console",
        "documentation": {}
    },
    {
        "label": "Console",
        "importPath": "rich.console",
        "description": "rich.console",
        "isExtraImport": true,
        "detail": "rich.console",
        "documentation": {}
    },
    {
        "label": "Console",
        "importPath": "rich.console",
        "description": "rich.console",
        "isExtraImport": true,
        "detail": "rich.console",
        "documentation": {}
    },
    {
        "label": "rich",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "rich",
        "description": "rich",
        "detail": "rich",
        "documentation": {}
    },
    {
        "label": "subprocess,",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "subprocess.",
        "description": "subprocess.",
        "detail": "subprocess.",
        "documentation": {}
    },
    {
        "label": "get_logger",
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "isExtraImport": true,
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "get_logger",
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "isExtraImport": true,
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "get_logger",
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "isExtraImport": true,
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "logging",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "logging",
        "description": "logging",
        "detail": "logging",
        "documentation": {}
    },
    {
        "label": "sys",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sys",
        "description": "sys",
        "detail": "sys",
        "documentation": {}
    },
    {
        "label": "RotatingFileHandler",
        "importPath": "logging.handlers",
        "description": "logging.handlers",
        "isExtraImport": true,
        "detail": "logging.handlers",
        "documentation": {}
    },
    {
        "label": "subprocess",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "subprocess",
        "description": "subprocess",
        "detail": "subprocess",
        "documentation": {}
    },
    {
        "label": "os,",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os.",
        "description": "os.",
        "detail": "os.",
        "documentation": {}
    },
    {
        "label": "create_default_rules",
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "isExtraImport": true,
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "interactive_add_rule",
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "isExtraImport": true,
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "validate_configuration",
        "importPath": "modules.configuration.validate_conf",
        "description": "modules.configuration.validate_conf",
        "isExtraImport": true,
        "detail": "modules.configuration.validate_conf",
        "documentation": {}
    },
    {
        "label": "create_account_cli",
        "importPath": "modules.acc_managt.creat_acc",
        "description": "modules.acc_managt.creat_acc",
        "isExtraImport": true,
        "detail": "modules.acc_managt.creat_acc",
        "documentation": {}
    },
    {
        "label": "delete_account_cli",
        "importPath": "modules.acc_managt.delete_acc",
        "description": "modules.acc_managt.delete_acc",
        "isExtraImport": true,
        "detail": "modules.acc_managt.delete_acc",
        "documentation": {}
    },
    {
        "label": "update_account_cli",
        "importPath": "modules.acc_managt.update_acc",
        "description": "modules.acc_managt.update_acc",
        "isExtraImport": true,
        "detail": "modules.acc_managt.update_acc",
        "documentation": {}
    },
    {
        "label": "disable_rule",
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "isExtraImport": true,
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "enable_rule",
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "isExtraImport": true,
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "list_rules",
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "isExtraImport": true,
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "build_ruleset",
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "isExtraImport": true,
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "backup_rules",
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "isExtraImport": true,
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "activenv",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "activenv",
        "description": "activenv",
        "detail": "activenv",
        "documentation": {}
    },
    {
        "label": "setup",
        "importPath": "setuptools",
        "description": "setuptools",
        "isExtraImport": true,
        "detail": "setuptools",
        "documentation": {}
    },
    {
        "label": "find_packages",
        "importPath": "setuptools",
        "description": "setuptools",
        "isExtraImport": true,
        "detail": "setuptools",
        "documentation": {}
    },
    {
        "label": "install",
        "importPath": "setuptools.command.install",
        "description": "setuptools.command.install",
        "isExtraImport": true,
        "detail": "setuptools.command.install",
        "documentation": {}
    },
    {
        "label": "exists",
        "importPath": "os.path",
        "description": "os.path",
        "isExtraImport": true,
        "detail": "os.path",
        "documentation": {}
    },
    {
        "label": "main",
        "importPath": "version",
        "description": "version",
        "isExtraImport": true,
        "detail": "version",
        "documentation": {}
    },
    {
        "label": "create_account",
        "kind": 2,
        "importPath": "build.lib.modules.acc_managt.creat_acc",
        "description": "build.lib.modules.acc_managt.creat_acc",
        "peekOfCode": "def create_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        username = input(\n            \"Username (it is a one time creation ))\",\n        )\n        Fullname = input(\n            \"Fullname \",\n        )\n        Password = input(\"Enter your pin or password: \")",
        "detail": "build.lib.modules.acc_managt.creat_acc",
        "documentation": {}
    },
    {
        "label": "ACCOUNTS_FILE",
        "kind": 5,
        "importPath": "build.lib.modules.acc_managt.creat_acc",
        "description": "build.lib.modules.acc_managt.creat_acc",
        "peekOfCode": "ACCOUNTS_FILE = \"accounts.json\"\ndef _accounts_path(root: Path) -> Path:\n    return root / ACCOUNTS_FILE\n# def create_account(root: Path):\n#     p = _accounts_path(root)\n#     if not p.exists():\n#         p.write_text(\"{}\")\n#     data = json.loads(p.read_text())\n#     username = input(\"Enter username: \")\n#     if username in data:",
        "detail": "build.lib.modules.acc_managt.creat_acc",
        "documentation": {}
    },
    {
        "label": "data",
        "kind": 5,
        "importPath": "build.lib.modules.acc_managt.creat_acc",
        "description": "build.lib.modules.acc_managt.creat_acc",
        "peekOfCode": "data = {}\ndef create_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        username = input(\n            \"Username (it is a one time creation ))\",\n        )\n        Fullname = input(\n            \"Fullname \",\n        )",
        "detail": "build.lib.modules.acc_managt.creat_acc",
        "documentation": {}
    },
    {
        "label": "delete_account",
        "kind": 2,
        "importPath": "build.lib.modules.acc_managt.delete_acc",
        "description": "build.lib.modules.acc_managt.delete_acc",
        "peekOfCode": "def delete_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        print(\"No accounts file found\")\n        return\n    data = json.loads(p.read_text())\n    username = input(\"Enter username to delete: \")\n    if username not in data:\n        print(\"User not found\")\n        return",
        "detail": "build.lib.modules.acc_managt.delete_acc",
        "documentation": {}
    },
    {
        "label": "ACCOUNTS_FILE",
        "kind": 5,
        "importPath": "build.lib.modules.acc_managt.delete_acc",
        "description": "build.lib.modules.acc_managt.delete_acc",
        "peekOfCode": "ACCOUNTS_FILE = \"accounts.json\"\ndef _accounts_path(root: Path) -> Path:\n    return root / ACCOUNTS_FILE\ndef delete_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        print(\"No accounts file found\")\n        return\n    data = json.loads(p.read_text())\n    username = input(\"Enter username to delete: \")",
        "detail": "build.lib.modules.acc_managt.delete_acc",
        "documentation": {}
    },
    {
        "label": "update_account",
        "kind": 2,
        "importPath": "build.lib.modules.acc_managt.update_acc",
        "description": "build.lib.modules.acc_managt.update_acc",
        "peekOfCode": "def update_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        print(\"No accounts file found\")\n        return\n    data = json.loads(p.read_text())\n    username = input(\"Enter username to update: \")\n    if username not in data:\n        print(\"User not found\")\n        return",
        "detail": "build.lib.modules.acc_managt.update_acc",
        "documentation": {}
    },
    {
        "label": "ACCOUNTS_FILE",
        "kind": 5,
        "importPath": "build.lib.modules.acc_managt.update_acc",
        "description": "build.lib.modules.acc_managt.update_acc",
        "peekOfCode": "ACCOUNTS_FILE = \"accounts.json\"\ndef _accounts_path(root: Path) -> Path:\n    return root / ACCOUNTS_FILE\ndef update_account(root: Path):\n    p = _accounts_path(root)\n    if not p.exists():\n        print(\"No accounts file found\")\n        return\n    data = json.loads(p.read_text())\n    username = input(\"Enter username to update: \")",
        "detail": "build.lib.modules.acc_managt.update_acc",
        "documentation": {}
    },
    {
        "label": "modify_conf",
        "kind": 2,
        "importPath": "build.lib.modules.configuration.modify_conf",
        "description": "build.lib.modules.configuration.modify_conf",
        "peekOfCode": "def modify_conf(root: Path, changes: dict):\n    # Very small demonstration: append a line to snort.conf.template\n    tpl = root / \"templates\" / \"snort.conf.tpl\"\n    if not tpl.exists():\n        print(\"Template not found\")\n        return\n    with open(tpl, \"a\") as f:\n        for k, v in changes.items():\n            f.write(f\"# {k} -> {v}\\n\")\n    print(\"Modified template (demo)\")",
        "detail": "build.lib.modules.configuration.modify_conf",
        "documentation": {}
    },
    {
        "label": "create_default_rules",
        "kind": 2,
        "importPath": "build.lib.modules.configuration.setup_rules",
        "description": "build.lib.modules.configuration.setup_rules",
        "peekOfCode": "def create_default_rules(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.write_text(\"\".join(DEFAULT_RULES))\n        print(f\"Created default local.rules at {local_rules}\")\n    else:\n        print(\"local.rules already exists\")\ndef interactive_add_rule(root: Path):",
        "detail": "build.lib.modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "interactive_add_rule",
        "kind": 2,
        "importPath": "build.lib.modules.configuration.setup_rules",
        "description": "build.lib.modules.configuration.setup_rules",
        "peekOfCode": "def interactive_add_rule(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.write_text(\"\".join(DEFAULT_RULES))\n        print(\"Add a simple alert rule (demo)\")\n        proto = input(\"Protocol (tcp/udp/icmp): \")\n        src = input(\"Source (e.g. any): \")\n        src_port = input(\"Source port (e.g. any): \")",
        "detail": "build.lib.modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "list_local_rules",
        "kind": 2,
        "importPath": "build.lib.modules.configuration.setup_rules",
        "description": "build.lib.modules.configuration.setup_rules",
        "peekOfCode": "def list_local_rules(root: Path):\n    local_rules = root / \"rules\" / \"local.rules\"\n    if not local_rules.exists():\n        print(\"No local.rules found. Run `python main.py setup` to create defaults.\")\n        return\n    print(local_rules.read_text())",
        "detail": "build.lib.modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "DEFAULT_RULES",
        "kind": 5,
        "importPath": "build.lib.modules.configuration.setup_rules",
        "description": "build.lib.modules.configuration.setup_rules",
        "peekOfCode": "DEFAULT_RULES = [\n    \"# Local rule format (demo)\\n\",\n    'alert icmp any any -> any any (msg:\"ICMP detected\"; sid:1000001; rev:1;)\\n',\n]\ndef create_default_rules(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.write_text(\"\".join(DEFAULT_RULES))",
        "detail": "build.lib.modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "validate_configuration",
        "kind": 2,
        "importPath": "build.lib.modules.configuration.validate_conf",
        "description": "build.lib.modules.configuration.validate_conf",
        "peekOfCode": "def validate_configuration(root: Path):\n    # Simple validation: check that rules file exists and is not empty\n    rules = root / \"rules\" / \"local.rules\"\n    if not rules.exists():\n        print(\"Validation failed: local.rules missing\")\n        return False\n    content = rules.read_text().strip()\n    if not content:\n        print(\"Validation failed: local.rules is empty\")\n        return False",
        "detail": "build.lib.modules.configuration.validate_conf",
        "documentation": {}
    },
    {
        "label": "check_snort",
        "kind": 2,
        "importPath": "build.lib.modules.utilities.check_depend",
        "description": "build.lib.modules.utilities.check_depend",
        "peekOfCode": "def check_snort():\n    path = shutil.which(\"snort\")\n    if path:\n        print(f\"Found snort at: {path}\")\n        return True\n    else:\n        print(\"snort executable not found in PATH. Some features may not work.\")\n        return False",
        "detail": "build.lib.modules.utilities.check_depend",
        "documentation": {}
    },
    {
        "label": "handle_error",
        "kind": 2,
        "importPath": "build.lib.modules.utilities.error_hander",
        "description": "build.lib.modules.utilities.error_hander",
        "peekOfCode": "def handle_error(e: Exception, context: str = \"\"):\n    print(f\"ERROR in {context}: {e}\")",
        "detail": "build.lib.modules.utilities.error_hander",
        "documentation": {}
    },
    {
        "label": "get_connection",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def get_connection():\n    conn = sqlite3.connect(DB_PATH)\n    conn.row_factory = sqlite3.Row  # allows dict-like access\n    return conn\n# -------------------------\n# Password hashing\n# -------------------------\ndef hash_password(plaintext: str) -> str:\n    return hashlib.sha256(plaintext.encode(\"utf-8\")).hexdigest()\n# -------------------------",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "hash_password",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def hash_password(plaintext: str) -> str:\n    return hashlib.sha256(plaintext.encode(\"utf-8\")).hexdigest()\n# -------------------------\n# Initialize DB\n# -------------------------\ndef init_db():\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\n        \"\"\"",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "init_db",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def init_db():\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\n        \"\"\"\n        CREATE TABLE IF NOT EXISTS accounts (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            fullname TEXT,\n            password TEXT NOT NULL,",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "create_account",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def create_account(username: str, fullname: str, password: str) -> bool:\n    conn = get_connection()\n    cur = conn.cursor()\n    try:\n        cur.execute(\n            \"INSERT INTO accounts (username, fullname, password) VALUES (?, ?, ?)\",\n            (username, fullname, hash_password(password)),\n        )\n        conn.commit()\n        return True",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "get_account",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def get_account(username: str) -> Optional[Dict[str, Any]]:\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\n        \"SELECT id, username, fullname, created_at FROM accounts WHERE username = ?\",\n        (username,),\n    )\n    row = cur.fetchone()\n    conn.close()\n    return dict(row) if row else None",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "verify_password",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def verify_password(username: str, password: str) -> bool:\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\"SELECT password FROM accounts WHERE username = ?\", (username,))\n    row = cur.fetchone()\n    conn.close()\n    if not row:\n        return False\n    return row[\"password\"] == hash_password(password)\ndef update_account(",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "update_account",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def update_account(\n    username: str,\n    new_fullname: Optional[str] = None,\n    new_password: Optional[str] = None,\n) -> bool:\n    conn = get_connection()\n    cur = conn.cursor()\n    # ensure user exists\n    cur.execute(\"SELECT id FROM accounts WHERE username = ?\", (username,))\n    if not cur.fetchone():",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "delete_account",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def delete_account(username: str) -> bool:\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\"DELETE FROM accounts WHERE username = ?\", (username,))\n    changed = cur.rowcount\n    conn.commit()\n    conn.close()\n    return changed > 0\ndef list_accounts() -> list:\n    conn = get_connection()",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "list_accounts",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def list_accounts() -> list:\n    conn = get_connection()\n    cur = conn.cursor()\n    cur.execute(\"SELECT id, username, fullname, created_at FROM accounts ORDER BY id\")\n    rows = cur.fetchall()\n    conn.close()\n    return [dict(r) for r in rows]\n# -------------------------\n# Migrate from JSON\n# -------------------------",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "migrate_from_json",
        "kind": 2,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "def migrate_from_json(project_root: Path) -> int:\n    json_path = project_root / \"accounts.json\"\n    if not json_path.exists():\n        return 0\n    count = 0\n    with json_path.open() as f:\n        data = json.load(f)\n    for username, info in data.items():\n        fullname = info.get(\"Fullname\") or info.get(\"fullname\") or \"\"\n        password = info.get(\"Password\") or info.get(\"password\") or \"\"",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "OS_TYPE",
        "kind": 5,
        "importPath": "database.db",
        "description": "database.db",
        "peekOfCode": "OS_TYPE = platform.system().lower()\n# -------------------------\n# Database paths\n# -------------------------\nif OS_TYPE == \"windows\":\n    USERDIR = os.getlogin()\n    LOCAL_APPDATA = f\"C:\\\\Users\\\\{USERDIR}\\\\Desktop\"\n    APP_DIR = Path(LOCAL_APPDATA) / \"SnortAMV\"\n    APP_DIR.mkdir(parents=True, exist_ok=True)\n    DB_PATH = APP_DIR / \"sqlite.db\"",
        "detail": "database.db",
        "documentation": {}
    },
    {
        "label": "create_account_cli",
        "kind": 2,
        "importPath": "modules.acc_managt.creat_acc",
        "description": "modules.acc_managt.creat_acc",
        "peekOfCode": "def create_account_cli(root: Path):\n    username = input(\"Enter username: \").strip()\n    if get_account(username):\n        print(\"User already exists\")\n        return\n    fullname = input(\"Full name: \").strip()\n    password = input(\"Password: \").strip()\n    ok = create_account(username, fullname, password)\n    if ok:\n        print(f\"Created account: {username}\")",
        "detail": "modules.acc_managt.creat_acc",
        "documentation": {}
    },
    {
        "label": "delete_account_cli",
        "kind": 2,
        "importPath": "modules.acc_managt.delete_acc",
        "description": "modules.acc_managt.delete_acc",
        "peekOfCode": "def delete_account_cli(root: Path):\n    username = input(\"Enter username to delete: \").strip()\n    acc = get_account(username)\n    if not acc:\n        print(\"User not found\")\n        return\n    password = input(\"Enter your password to confirm deletion: \").strip()\n    if not verify_password(username, password):\n        print(\"Incorrect password\")\n        return",
        "detail": "modules.acc_managt.delete_acc",
        "documentation": {}
    },
    {
        "label": "migrate_acc",
        "kind": 2,
        "importPath": "modules.acc_managt.migrate",
        "description": "modules.acc_managt.migrate",
        "peekOfCode": "def migrate_acc():\n    print(\"account created \", db.migrate_from_json(Path.cwd())+1 )\nmigrate_acc()\nif __name__ == \"__main__\":\n    migrate_acc()",
        "detail": "modules.acc_managt.migrate",
        "documentation": {}
    },
    {
        "label": "update_account_cli",
        "kind": 2,
        "importPath": "modules.acc_managt.update_acc",
        "description": "modules.acc_managt.update_acc",
        "peekOfCode": "def update_account_cli(root: Path):\n    username = input(\"Enter username to update: \").strip()\n    acc = get_account(username)\n    if not acc:\n        print(\"User not found\")\n        return\n    password = input(\"Enter your password to confirm: \").strip()\n    if not verify_password(username, password):\n        print(\"Incorrect password.\")\n        return",
        "detail": "modules.acc_managt.update_acc",
        "documentation": {}
    },
    {
        "label": "modify_conf",
        "kind": 2,
        "importPath": "modules.configuration.modify_conf",
        "description": "modules.configuration.modify_conf",
        "peekOfCode": "def modify_conf(root: Path, changes: dict):\n    # Very small demonstration: append a line to snort.conf.template\n    tpl = root / \"templates\" / \"snort.conf.tpl\"\n    if not tpl.exists():\n        print(\"Template not found\")\n        return\n    with open(tpl, \"a\") as f:\n        for k, v in changes.items():\n            f.write(f\"# {k} -> {v}\\n\")\n    print(\"Modified template (demo)\")",
        "detail": "modules.configuration.modify_conf",
        "documentation": {}
    },
    {
        "label": "list_rules",
        "kind": 2,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "def list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")\n    for f in ENABLED.glob(\"*.rules\"):\n        console.print(f\"  âœ” {f.name}\")\n    console.print(\"\\n[bold yellow]Disabled rules:[/bold yellow]\")\n    for f in DISABLED.glob(\"*.rules\"):\n        console.print(f\"  âœ– {f.name}\")\n    console.print(\"\\n[bold cyan]Source rules:[/bold cyan]\")\n    for f in SOURCES.glob(\"*.rules\"):\n        console.print(f\"  ðŸ“„ {f.name}\")",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "enable_rule",
        "kind": 2,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "def enable_rule(name: str, dry_run=False):\n    src = SOURCES / name\n    dst = ENABLED / name\n    if not src.exists():\n        console.print(f\"[red]Rule not found: {name}[/red]\")\n        return\n    if dry_run:\n        console.print(f\"[yellow][DRY-RUN] enable {name}[/yellow]\")\n        return\n    shutil.copy2(src, dst)",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "disable_rule",
        "kind": 2,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "def disable_rule(name: str, dry_run=False):\n    src = ENABLED / name\n    dst = DISABLED / name\n    if not src.exists():\n        console.print(f\"[red]Rule not enabled: {name}[/red]\")\n        return\n    if dry_run:\n        console.print(f\"[yellow][DRY-RUN] disable {name}[/yellow]\")\n        return\n    shutil.move(src, dst)",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "build_ruleset",
        "kind": 2,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "def build_ruleset(dry_run=False):\n    target = GENERATED / \"snort.rules\"\n    rules = []\n    for rule_file in ENABLED.glob(\"*.rules\"):\n        rules.append(rule_file.read_text())\n    if dry_run:\n        console.print(\n            f\"[yellow][DRY-RUN] build ruleset with {len(rules)} files[/yellow]\"\n        )\n        return",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "backup_rules",
        "kind": 2,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "def backup_rules():\n    ts = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n    archive = BACKUPS / f\"rules_{ts}\"\n    shutil.make_archive(str(archive), \"gztar\", RULES_DIR)\n    console.print(f\"[blue]Rules backed up â†’ {archive}.tar.gz[/blue]\")",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "console",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "console = Console()\nROOT = Path(__file__).resolve().parents[2]\nRULES_DIR = ROOT / \"rules\"\nSOURCES = RULES_DIR / \"sources\"\nENABLED = RULES_DIR / \"enabled\"\nDISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "ROOT",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "ROOT = Path(__file__).resolve().parents[2]\nRULES_DIR = ROOT / \"rules\"\nSOURCES = RULES_DIR / \"sources\"\nENABLED = RULES_DIR / \"enabled\"\nDISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "RULES_DIR",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "RULES_DIR = ROOT / \"rules\"\nSOURCES = RULES_DIR / \"sources\"\nENABLED = RULES_DIR / \"enabled\"\nDISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "SOURCES",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "SOURCES = RULES_DIR / \"sources\"\nENABLED = RULES_DIR / \"enabled\"\nDISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "ENABLED",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "ENABLED = RULES_DIR / \"enabled\"\nDISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")\n    for f in ENABLED.glob(\"*.rules\"):",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "DISABLED",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "DISABLED = RULES_DIR / \"disabled\"\nGENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")\n    for f in ENABLED.glob(\"*.rules\"):\n        console.print(f\"  âœ” {f.name}\")",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "GENERATED",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "GENERATED = RULES_DIR / \"generated\"\nBACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")\n    for f in ENABLED.glob(\"*.rules\"):\n        console.print(f\"  âœ” {f.name}\")\n    console.print(\"\\n[bold yellow]Disabled rules:[/bold yellow]\")",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "BACKUPS",
        "kind": 5,
        "importPath": "modules.configuration.rule_manager",
        "description": "modules.configuration.rule_manager",
        "peekOfCode": "BACKUPS = RULES_DIR / \"backups\"\nfor d in [SOURCES, ENABLED, DISABLED, GENERATED, BACKUPS]:\n    d.mkdir(parents=True, exist_ok=True)\n# ---------------- Core Ops ---------------- #\ndef list_rules():\n    console.print(\"\\n[bold green]Enabled rules:[/bold green]\")\n    for f in ENABLED.glob(\"*.rules\"):\n        console.print(f\"  âœ” {f.name}\")\n    console.print(\"\\n[bold yellow]Disabled rules:[/bold yellow]\")\n    for f in DISABLED.glob(\"*.rules\"):",
        "detail": "modules.configuration.rule_manager",
        "documentation": {}
    },
    {
        "label": "create_default_rules",
        "kind": 2,
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "peekOfCode": "def create_default_rules(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"generated\" / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.parent.mkdir(exist_ok=True)\n        local_rules.write_text(\"\".join(DEFAULT_RULES))\n        console.print(f\"Created default local.rules at {local_rules}\", style=\"green\")\n    else:\n        console.print(\"local.rules already exists\", style=\"yellow\")",
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "interactive_add_rule",
        "kind": 2,
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "peekOfCode": "def interactive_add_rule(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    default_rules = rules_dir / \"generated\" / \"local.rules\"\n    filename = input(\n        \"What name do want to give to your new rules file (without .rules extension): \"\n    ).strip()\n    local_rules = rules_dir / \"sources\" / f\"{filename}.rules\"\n    # Create file with default rules only once\n    if not local_rules.exists():",
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "list_local_rules",
        "kind": 2,
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "peekOfCode": "def list_local_rules(root: Path):\n    local_rules = root / \"rules\" / \"local.rules\"\n    if not local_rules.exists():\n        print(\"No local.rules found. Run `python main.py setup` to create defaults.\")\n        return\n    print(local_rules.read_text())",
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "console",
        "kind": 5,
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "peekOfCode": "console = Console()\nDEFAULT_RULES = [\n    'alert icmp any any -> any any (msg:\"ICMP detected\"; sid:1000001; rev:1;)\\n',\n]\ndef create_default_rules(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"generated\" / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.parent.mkdir(exist_ok=True)",
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "DEFAULT_RULES",
        "kind": 5,
        "importPath": "modules.configuration.setup_rules",
        "description": "modules.configuration.setup_rules",
        "peekOfCode": "DEFAULT_RULES = [\n    'alert icmp any any -> any any (msg:\"ICMP detected\"; sid:1000001; rev:1;)\\n',\n]\ndef create_default_rules(root: Path):\n    rules_dir = root / \"rules\"\n    rules_dir.mkdir(exist_ok=True)\n    local_rules = rules_dir / \"generated\" / \"local.rules\"\n    if not local_rules.exists():\n        local_rules.parent.mkdir(exist_ok=True)\n        local_rules.write_text(\"\".join(DEFAULT_RULES))",
        "detail": "modules.configuration.setup_rules",
        "documentation": {}
    },
    {
        "label": "validate_configuration",
        "kind": 2,
        "importPath": "modules.configuration.validate_conf",
        "description": "modules.configuration.validate_conf",
        "peekOfCode": "def validate_configuration(root: Path):\n    # Simple validation: check that rules file exists and is not empty\n    rules = root / \"rules\" / \"local.rules\"\n    if not rules.exists():\n        print(\"Validation failed: local.rules missing\")\n        return False\n    content = rules.read_text().strip()\n    if not content:\n        print(\"Validation failed: local.rules is empty\")\n        return False",
        "detail": "modules.configuration.validate_conf",
        "documentation": {}
    },
    {
        "label": "network_available",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def network_available(host=\"archive.ubuntu.com\", port=80, timeout=3):\n    try:\n        socket.setdefaulttimeout(timeout)\n        socket.create_connection((host, port))\n        return True\n    except OSError:\n        return False\ndef snort_installed():\n    return shutil.which(\"snort\") is not None or shutil.which(\"snort3\") is not None\ndef sudo_warm(dry_run=False):",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "snort_installed",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def snort_installed():\n    return shutil.which(\"snort\") is not None or shutil.which(\"snort3\") is not None\ndef sudo_warm(dry_run=False):\n    cmd = [\"sudo\", \"-V\"]\n    if dry_run:\n        console.print(f\"[DRY-RUN] would run {' '.join(cmd)}\", style=\"purple\")\n        logger.info(\"DRY-RUN %s\", cmd)\n        return\n    try:\n        subprocess.run(cmd, check=True, capture_output=True, text=True)",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "sudo_warm",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def sudo_warm(dry_run=False):\n    cmd = [\"sudo\", \"-V\"]\n    if dry_run:\n        console.print(f\"[DRY-RUN] would run {' '.join(cmd)}\", style=\"purple\")\n        logger.info(\"DRY-RUN %s\", cmd)\n        return\n    try:\n        subprocess.run(cmd, check=True, capture_output=True, text=True)\n        logger.info(f\"{cmd} completed\")\n    except subprocess.CalledProcessError as e:",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "sudo_cmd",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def sudo_cmd(cmd):\n    \"\"\"\n    Prefix command with sudo if not already root\n    \"\"\"\n    if os.geteuid() != 0:\n        return [\"sudo\"] + cmd\n    return cmd\n### This function will update the ubuntu or debian\ndef apt_update(dry_run=False):\n    console.print(\"Updating package index... .......\", style=\"green\")",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "apt_update",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def apt_update(dry_run=False):\n    console.print(\"Updating package index... .......\", style=\"green\")\n    time.sleep(0.2)\n    cmd = sudo_cmd([\"apt\", \"update\"])\n    if dry_run:\n        console.print(f\"[DRY-RUN] would run  {' '.join(cmd)}\", style=\"yellow\")\n        logger.info(\"DRY-RUN: %s\", cmd)\n        return\n    try:\n        subprocess.run(cmd, check=True, capture_output=True, text=True)",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "apt_upgrade",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def apt_upgrade(dry_run=False):\n    console.print(\" Upgrading installed packages (apt upgrade) .......\", style=\"green\")\n    time.sleep(0.2)\n    cmd = sudo_cmd([\"apt\", \"upgrade\", \"-y\"])\n    if dry_run:\n        console.print(f\"[DRY-RUN] Would run: {' '.join(cmd)}\", style=\"yellow\")\n        logger.info(\"DRY-RUN: %s\", cmd)\n        return\n    try:\n        subprocess.run(cmd, check=True, capture_output=True, text=True)",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "install_dependences",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def install_dependences(dry_run=False):\n    deps = [\n        \"build-essential\",\n        \"libpcap-dev\",\n        \"libpcre3-dev\",\n        \"libdumbnet-dev\",\n        \"zlib1g-dev\",\n        \"wget\",\n        \"curl\",\n    ]",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "install_snort",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def install_snort(dry_run=False):\n    console.print(f\"\\n[Process] Checking if Snort is installed...\", style=\"yellow\")\n    time.sleep(0.5)\n    if snort_installed():\n        logger.info(\"Snort already installed.\")\n        return\n    console.print(\n        f\"[Not Found] Snort not found. Installing Snort now...\\n\", style=\"red\"\n    )\n    cmd = sudo_cmd([\"apt\", \"install\", \"-y\", \"snort\"])",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "install_ubuntu_debian",
        "kind": 2,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "def install_ubuntu_debian(dry_run=False):\n    sudo_warm(dry_run=dry_run)\n    if not network_available():\n        console.print(\n        \"[bold red]âŒ Network check failed.[/bold red]\\n\"\n        \"Please ensure you have a working internet connection.\",\n        style=\"red\",\n    )\n        return\n    console.print(",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "logger",
        "kind": 5,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "logger = get_logger(__name__)\nconsole = Console()\ndef network_available(host=\"archive.ubuntu.com\", port=80, timeout=3):\n    try:\n        socket.setdefaulttimeout(timeout)\n        socket.create_connection((host, port))\n        return True\n    except OSError:\n        return False\ndef snort_installed():",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "console",
        "kind": 5,
        "importPath": "modules.OS_installer.apt",
        "description": "modules.OS_installer.apt",
        "peekOfCode": "console = Console()\ndef network_available(host=\"archive.ubuntu.com\", port=80, timeout=3):\n    try:\n        socket.setdefaulttimeout(timeout)\n        socket.create_connection((host, port))\n        return True\n    except OSError:\n        return False\ndef snort_installed():\n    return shutil.which(\"snort\") is not None or shutil.which(\"snort3\") is not None",
        "detail": "modules.OS_installer.apt",
        "documentation": {}
    },
    {
        "label": "check_snort",
        "kind": 2,
        "importPath": "modules.utilities.check_depend",
        "description": "modules.utilities.check_depend",
        "peekOfCode": "def check_snort():\n    path = shutil.which(\"snort\")\n    if path:\n        print(f\"Found snort at: {path}\")\n        return True\n    else:\n        print(\"snort executable not found in PATH. Some features may not work.\")\n        return False",
        "detail": "modules.utilities.check_depend",
        "documentation": {}
    },
    {
        "label": "handle_error",
        "kind": 2,
        "importPath": "modules.utilities.error_hander",
        "description": "modules.utilities.error_hander",
        "peekOfCode": "def handle_error(e: Exception, context: str = \"\"):\n    print(f\"ERROR in {context}: {e}\")",
        "detail": "modules.utilities.error_hander",
        "documentation": {}
    },
    {
        "label": "get_logger",
        "kind": 2,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "def get_logger(name: str = APP_NAME) -> logging.Logger:\n    return logging.getLogger(name)",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "APP_NAME",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "APP_NAME = \"snortamv\"\nOS_TYPE = platform.system().lower()\n# ---------------- Paths ----------------\nif OS_TYPE == \"windows\":\n    BASE_DIR = Path.cwd()\n    LOG_DIR = BASE_DIR / \"logStore\" / \"logs\"\nelif OS_TYPE == \"linux\":\n    LOG_DIR = Path(\"/var/log/snortamv\")\nelse:\n    print(\"Unsupported OS\")",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "OS_TYPE",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "OS_TYPE = platform.system().lower()\n# ---------------- Paths ----------------\nif OS_TYPE == \"windows\":\n    BASE_DIR = Path.cwd()\n    LOG_DIR = BASE_DIR / \"logStore\" / \"logs\"\nelif OS_TYPE == \"linux\":\n    LOG_DIR = Path(\"/var/log/snortamv\")\nelse:\n    print(\"Unsupported OS\")\n    sys.exit(1)",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "LOG_FILE",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "LOG_FILE = LOG_DIR / \"snortamv.log\"\n# ---------------- Logging Setup ----------------\nLOG_LEVEL = logging.INFO  # change to DEBUG for dev\nformatter = logging.Formatter(\"%(asctime)s | %(levelname)s | %(name)s | %(message)s\")\nfile_handler = RotatingFileHandler(\n    LOG_FILE, maxBytes=5 * 1024 * 1024, backupCount=5  # 5MB\n)\nfile_handler.setFormatter(formatter)\nconsole_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "LOG_LEVEL",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "LOG_LEVEL = logging.INFO  # change to DEBUG for dev\nformatter = logging.Formatter(\"%(asctime)s | %(levelname)s | %(name)s | %(message)s\")\nfile_handler = RotatingFileHandler(\n    LOG_FILE, maxBytes=5 * 1024 * 1024, backupCount=5  # 5MB\n)\nfile_handler.setFormatter(formatter)\nconsole_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)\nlogging.basicConfig(\n    level=LOG_LEVEL,",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "formatter",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "formatter = logging.Formatter(\"%(asctime)s | %(levelname)s | %(name)s | %(message)s\")\nfile_handler = RotatingFileHandler(\n    LOG_FILE, maxBytes=5 * 1024 * 1024, backupCount=5  # 5MB\n)\nfile_handler.setFormatter(formatter)\nconsole_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)\nlogging.basicConfig(\n    level=LOG_LEVEL,\n    handlers=[file_handler, console_handler],",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "file_handler",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "file_handler = RotatingFileHandler(\n    LOG_FILE, maxBytes=5 * 1024 * 1024, backupCount=5  # 5MB\n)\nfile_handler.setFormatter(formatter)\nconsole_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)\nlogging.basicConfig(\n    level=LOG_LEVEL,\n    handlers=[file_handler, console_handler],\n)",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "console_handler",
        "kind": 5,
        "importPath": "modules.utilities.logger",
        "description": "modules.utilities.logger",
        "peekOfCode": "console_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)\nlogging.basicConfig(\n    level=LOG_LEVEL,\n    handlers=[file_handler, console_handler],\n)\ndef get_logger(name: str = APP_NAME) -> logging.Logger:\n    return logging.getLogger(name)",
        "detail": "modules.utilities.logger",
        "documentation": {}
    },
    {
        "label": "test_app_runs",
        "kind": 2,
        "importPath": "tests.test_app_runs",
        "description": "tests.test_app_runs",
        "peekOfCode": "def test_app_runs():\n    assert True",
        "detail": "tests.test_app_runs",
        "documentation": {}
    },
    {
        "label": "create_venv",
        "kind": 2,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "def create_venv():\n    if not os.path.exists(VENV):\n        print(f\"[+] Creating environment... \")\n        subprocess.run([sys.executable, \"-m\", \"venv\", VENV], check=True)\n    else:\n        print(\"[+] Environment already exists.\")\ndef get_venv_python():\n    os_type = platform.system().lower()\n    if os_type == \"windows\":\n        return os.path.join(VENV, \"Scripts\", \"python.exe\")",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "get_venv_python",
        "kind": 2,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "def get_venv_python():\n    os_type = platform.system().lower()\n    if os_type == \"windows\":\n        return os.path.join(VENV, \"Scripts\", \"python.exe\")\n    else:\n        return os.path.join(VENV, \"bin\", \"python\")\ndef install_requirements(venv_python):\n    if not os.path.exists(\"requirements.txt\"):\n        print(\"[!] No requirements.txt found. Skipping...\")\n        return",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "install_requirements",
        "kind": 2,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "def install_requirements(venv_python):\n    if not os.path.exists(\"requirements.txt\"):\n        print(\"[!] No requirements.txt found. Skipping...\")\n        return\n    print(\"[+] Checking installed packages...\")\n    # Get installed packages inside venv\n    result = subprocess.run(\n        [venv_python, \"-m\", \"pip\", \"freeze\"],\n        capture_output=True,\n        text=True",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "run_app",
        "kind": 2,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "def run_app(venv_python):\n    print(\"\\n[+] Launching SnortAMV...\\n\")\n    if not os.path.exists(\"main.py\"):\n        print(\"âŒ ERROR: main.py not found!\")\n        return\n    subprocess.run([venv_python, \"main.py\"])\ndef show_manual_activation():\n    os_type = platform.system().lower()\n    print(\"\\n[!] If you want to activate environment manually:\")\n    if os_type == \"windows\":",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "show_manual_activation",
        "kind": 2,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "def show_manual_activation():\n    os_type = platform.system().lower()\n    print(\"\\n[!] If you want to activate environment manually:\")\n    if os_type == \"windows\":\n        print(\"    env\\\\Scripts\\\\activate\")\n    else:\n        print(\"    source env/bin/activate\")\n    print()\nif __name__ == \"__main__\":\n    print(\"[=] Detecting OS and preparing environment...\\n\")",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "VENV",
        "kind": 5,
        "importPath": "activate",
        "description": "activate",
        "peekOfCode": "VENV = \"env\"\ndef create_venv():\n    if not os.path.exists(VENV):\n        print(f\"[+] Creating environment... \")\n        subprocess.run([sys.executable, \"-m\", \"venv\", VENV], check=True)\n    else:\n        print(\"[+] Environment already exists.\")\ndef get_venv_python():\n    os_type = platform.system().lower()\n    if os_type == \"windows\":",
        "detail": "activate",
        "documentation": {}
    },
    {
        "label": "get_shell",
        "kind": 2,
        "importPath": "activenv",
        "description": "activenv",
        "peekOfCode": "def get_shell():\n    \"\"\"Detect current shell.\"\"\"\n    if os.name == \"nt\":  # Windows\n        parent = os.environ.get(\"COMSPEC\", \"\")\n        if \"powershell.exe\" in parent.lower():\n            return \"powershell\"\n        if \"cmd.exe\" in parent.lower():\n            return \"cmd\"\n        return \"cmd\"\n    # Linux / macOS",
        "detail": "activenv",
        "documentation": {}
    },
    {
        "label": "get_venv_paths",
        "kind": 2,
        "importPath": "activenv",
        "description": "activenv",
        "peekOfCode": "def get_venv_paths():\n    \"\"\"Return activation script paths for all OS/shell types.\"\"\"\n    return {\n        \"windows\": {\n            \"powershell\": os.path.join(VENV, \"Scripts\", \"Activate.ps1\"),\n            \"cmd\": os.path.join(VENV, \"Scripts\", \"activate.bat\"),\n            \"python\": os.path.join(VENV, \"Scripts\", \"python.exe\")\n        },\n        \"unix\": {\n            \"bash\": os.path.join(VENV, \"bin\", \"activate\"),",
        "detail": "activenv",
        "documentation": {}
    },
    {
        "label": "activate_and_run",
        "kind": 2,
        "importPath": "activenv",
        "description": "activenv",
        "peekOfCode": "def activate_and_run():\n    os_type = platform.system().lower()\n    shell = get_shell()\n    paths = get_venv_paths()\n    print(f\"Detected OS: {os_type}\")\n    print(f\"Detected shell: {shell}\")\n    # 1. WINDOWS\n    if os_type == \"windows\":\n        p = paths[\"windows\"][\"python\"]\n        if os.path.exists(p):",
        "detail": "activenv",
        "documentation": {}
    },
    {
        "label": "VENV",
        "kind": 5,
        "importPath": "activenv",
        "description": "activenv",
        "peekOfCode": "VENV = \"env\"   # Change if your venv folder has a different name\ndef get_shell():\n    \"\"\"Detect current shell.\"\"\"\n    if os.name == \"nt\":  # Windows\n        parent = os.environ.get(\"COMSPEC\", \"\")\n        if \"powershell.exe\" in parent.lower():\n            return \"powershell\"\n        if \"cmd.exe\" in parent.lower():\n            return \"cmd\"\n        return \"cmd\"",
        "detail": "activenv",
        "documentation": {}
    },
    {
        "label": "get_linux_distro",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:\n            k, v = line.split(\"=\", 1)\n            data[k] = v.strip('\"')\n    return {",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "distro_detector",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def distro_detector():\n    distro = get_linux_distro()\n    if OS_TYPE == \"linux\":\n        if not distro:\n            print(\" Cannot detect Linux distro\")\n            sys.exit(1)\n        print(f\"Running on {distro['name']} {distro['version']}\")\n    else:\n        return\ndef get_pkg_manager(distro):",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "get_pkg_manager",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def get_pkg_manager(distro):\n    distro_id = distro[\"id\"]\n    if distro_id in (\"ubuntu\", \"debian\"):\n        return \"apt\"\n    if distro_id in (\"fedora\", \"rhel\", \"centos\"):\n        return \"dnf\"\n    if distro_id in (\"arch\", \"manjaro\"):\n        return \"pacman\"\n    return None\n# ---------------- UI ----------------",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "greeting_by_time",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def greeting_by_time():\n    hour = int(time.strftime(\"%H\"))\n    if hour < 12:\n        return \"Good Morning\"\n    elif hour < 17:\n        return \"Good Afternoon\"\n    elif hour < 21:\n        return \"Good Evening\"\n    return \"Good Night\"\ndef banner():",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "banner",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def banner():\n    console.print(pyfiglet.figlet_format(\"SNORT AMV\"), style=\"bold green\")\n    console.print(f\"{greeting_by_time()} ðŸ‘‹\", style=\"green\")\n# ---------------- Core ----------------\ndef check_snort():\n    snort_path = shutil.which(\"snort\") or shutil.which(\"snort3\")\n    if not snort_path:\n        logger.warning(\"Snort not detected\")\n    return snort_path\ndef setup_cmd(_):",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "check_snort",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def check_snort():\n    snort_path = shutil.which(\"snort\") or shutil.which(\"snort3\")\n    if not snort_path:\n        logger.warning(\"Snort not detected\")\n    return snort_path\ndef setup_cmd(_):\n    if OS_TYPE == \"linux\":\n        try:\n            result = subprocess.run([sys.executable, \"post_installer.py\"], check=True)\n            if result.returncode != 0:",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "setup_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def setup_cmd(_):\n    if OS_TYPE == \"linux\":\n        try:\n            result = subprocess.run([sys.executable, \"post_installer.py\"], check=True)\n            if result.returncode != 0:\n                logger.error(\"Post installation failed: %s\", result.stderr)\n            else:\n                logger.info(\"Post installation completed successfully\")\n        except Exception as e:\n            logger.error(\"Error during post installation: %s\", e)",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "run_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def run_cmd(_):\n    if OS_TYPE == \"linux\":\n        try:\n            subprocess.run([\"bash\", \"snort_auto.bash\"], check=True)\n        except subprocess.CalledProcessError as e:\n            logger.error(\"Snort run failed: %s\", e)\n            logger.error(\"Stdout: %s\", e.stdout)\n            logger.error(\"Stderr: %s\", e.stderr)\n            return\n    elif OS_TYPE == \"windows\":",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "decrypt_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def decrypt_cmd(_):\n    if OS_TYPE == \"linux\":\n        cmd = [\"bash\", \"decrypt.bash\"]\n    elif OS_TYPE == \"windows\":\n        cmd = [\n            \"powershell\",\n            \"-ExecutionPolicy\",\n            \"Bypass\",\n            \"-File\",\n            \"decrypt.ps1\",",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "version_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def version_cmd(_):\n    print(f\"SnortAMV v{VERSION}\")\ndef create_acc(_):\n    from modules.acc_managt.migrate import migrate_acc\n    try:\n        # Creates the account\n        create_account_cli(ROOT)\n        #  migrates the account to the database\n        migrate_acc()\n        logger.info(\"Account Created successfully\")",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "create_acc",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def create_acc(_):\n    from modules.acc_managt.migrate import migrate_acc\n    try:\n        # Creates the account\n        create_account_cli(ROOT)\n        #  migrates the account to the database\n        migrate_acc()\n        logger.info(\"Account Created successfully\")\n    except error as e:\n        logger.error(\"Any error occured while creating account\", e.stdout)",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "rule_enable_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def rule_enable_cmd(args):\n    enable_rule(args.name, dry_run=args.dry_run)\ndef rule_disable_cmd(args):\n    disable_rule(args.name, dry_run=args.dry_run)\ndef rule_build_cmd(args):\n    build_ruleset(dry_run=args.dry_run)\n# ---------------- CLI ----------------\ndef main():\n    banner()\n    parser = argparse.ArgumentParser(description=\"SnortAMV â€“ Automated Snort Manager\")",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "rule_disable_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def rule_disable_cmd(args):\n    disable_rule(args.name, dry_run=args.dry_run)\ndef rule_build_cmd(args):\n    build_ruleset(dry_run=args.dry_run)\n# ---------------- CLI ----------------\ndef main():\n    banner()\n    parser = argparse.ArgumentParser(description=\"SnortAMV â€“ Automated Snort Manager\")\n    parser.add_argument(\n        \"--dry-run\",",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "rule_build_cmd",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def rule_build_cmd(args):\n    build_ruleset(dry_run=args.dry_run)\n# ---------------- CLI ----------------\ndef main():\n    banner()\n    parser = argparse.ArgumentParser(description=\"SnortAMV â€“ Automated Snort Manager\")\n    parser.add_argument(\n        \"--dry-run\",\n        action=\"store_true\",\n        help=\"Simulate actions without making changes\",",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "def main():\n    banner()\n    parser = argparse.ArgumentParser(description=\"SnortAMV â€“ Automated Snort Manager\")\n    parser.add_argument(\n        \"--dry-run\",\n        action=\"store_true\",\n        help=\"Simulate actions without making changes\",\n    )\n    sub = parser.add_subparsers(dest=\"command\", required=True)\n    sub.add_parser(\"setup\", help=\"Run initial setup\").set_defaults(func=setup_cmd)",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "ROOT",
        "kind": 5,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "ROOT = Path(__file__).parent.resolve()\nif str(ROOT) not in sys.path:\n    sys.path.insert(0, str(ROOT))\nconsole = Console()\nOS_TYPE = platform.system().lower()\nVERSION = \"0.0.1\"\nlogger = get_logger(__name__)\n# -------------------- Helper Functions --------------------\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "console",
        "kind": 5,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "console = Console()\nOS_TYPE = platform.system().lower()\nVERSION = \"0.0.1\"\nlogger = get_logger(__name__)\n# -------------------- Helper Functions --------------------\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "OS_TYPE",
        "kind": 5,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "OS_TYPE = platform.system().lower()\nVERSION = \"0.0.1\"\nlogger = get_logger(__name__)\n# -------------------- Helper Functions --------------------\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "VERSION",
        "kind": 5,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "VERSION = \"0.0.1\"\nlogger = get_logger(__name__)\n# -------------------- Helper Functions --------------------\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "logger",
        "kind": 5,
        "importPath": "cli",
        "description": "cli",
        "peekOfCode": "logger = get_logger(__name__)\n# -------------------- Helper Functions --------------------\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:\n            k, v = line.split(\"=\", 1)",
        "detail": "cli",
        "documentation": {}
    },
    {
        "label": "get_linux_distro",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:\n            k, v = line.split(\"=\", 1)\n            data[k] = v.strip('\"')\n    return {",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "distro_detector",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def distro_detector():\n    distro = get_linux_distro()\n    if os_type == \"linux\":\n        if not distro:\n            print(\" Cannot detect Linux distro\")\n            sys.exit(1)\n        print(f\"Running on {distro['name']} {distro['version']}\")\n    else:\n        return\ndistro_detector()",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "get_pkg_manager",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def get_pkg_manager(distro):\n    distro_id = distro[\"id\"]\n    if distro_id in (\"ubuntu\", \"debian\"):\n        return \"apt\"\n    if distro_id in (\"fedora\", \"rhel\", \"centos\"):\n        return \"dnf\"\n    if distro_id in (\"arch\", \"manjaro\"):\n        return \"pacman\"\n    return None\ndef get_aur_helper():",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "get_aur_helper",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def get_aur_helper():\n    for helper in (\"yay\", \"paru\"):\n        if shutil.which(helper):\n            return helper\n    return None\n# ---------------------------------------\n#   CHECK if Snort is installed\n# ---------------------------------------\ndef snort_installed():\n    return shutil.which(\"snort\") is not None or shutil.which(\"snort3\") is not None",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "snort_installed",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def snort_installed():\n    return shutil.which(\"snort\") is not None or shutil.which(\"snort3\") is not None\n# ---------------------------------------\n#   INSTALL SNORT 3 BY OS\n# ---------------------------------------\ndef install_snort():\n    os_type = platform.system().lower()\n    print(f\"\\n[=] Checking if Snort is installed...\")\n    if snort_installed():\n        logger.info(\"Snort already installed.\")",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "install_snort",
        "kind": 2,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "def install_snort():\n    os_type = platform.system().lower()\n    print(f\"\\n[=] Checking if Snort is installed...\")\n    if snort_installed():\n        logger.info(\"Snort already installed.\")\n        return\n    print(f\"[+] Snort not found. Installing Snort 3...\\n\")\n    # -------------------------------\n    # WINDOWS\n    # -------------------------------",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "os_type",
        "kind": 5,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "os_type = platform.system().lower()\nfrom modules.utilities.logger import get_logger\nlogger = get_logger(__name__)\nVENV = \"env\"\n# ================Distro Detection================\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "logger",
        "kind": 5,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "logger = get_logger(__name__)\nVENV = \"env\"\n# ================Distro Detection================\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "VENV",
        "kind": 5,
        "importPath": "post_installer",
        "description": "post_installer",
        "peekOfCode": "VENV = \"env\"\n# ================Distro Detection================\ndef get_linux_distro():\n    os_release = Path(\"/etc/os-release\")\n    if not os_release.exists():\n        return None\n    data = {}\n    for line in os_release.read_text().splitlines():\n        if \"=\" in line:\n            k, v = line.split(\"=\", 1)",
        "detail": "post_installer",
        "documentation": {}
    },
    {
        "label": "PostInstallCommand",
        "kind": 6,
        "importPath": "setup",
        "description": "setup",
        "peekOfCode": "class PostInstallCommand(install):\n    \"\"\"Run post_installer.py automatically after pip install.\"\"\"\n    def run(self):\n        install.run(self)\n        # If a requirements.txt exists, try to install it first using pip\n        req_file = \"requirements.txt\"\n        linux_req_file = \"linux_requirements.txt\"\n        try:\n            if OS_TYPE == \"windows\":\n                if exists(req_file):",
        "detail": "setup",
        "documentation": {}
    },
    {
        "label": "OS_TYPE",
        "kind": 5,
        "importPath": "setup",
        "description": "setup",
        "peekOfCode": "OS_TYPE = platform.system().lower()\nclass PostInstallCommand(install):\n    \"\"\"Run post_installer.py automatically after pip install.\"\"\"\n    def run(self):\n        install.run(self)\n        # If a requirements.txt exists, try to install it first using pip\n        req_file = \"requirements.txt\"\n        linux_req_file = \"linux_requirements.txt\"\n        try:\n            if OS_TYPE == \"windows\":",
        "detail": "setup",
        "documentation": {}
    }
]