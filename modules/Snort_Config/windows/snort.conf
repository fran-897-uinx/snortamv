###########################################
# Minimal Snort 2.9.20 Configuration File #
###########################################

# Step 1: Define network variables
var HOME_NET any
var EXTERNAL_NET any

# Step 2: Define paths
var RULE_PATH C:\Snort\rules
var SO_RULE_PATH C:\Snort\so_rules
var PREPROC_RULE_PATH C:\Snort\preproc_rules

# Step 3: Logging directory
var SNORT_LOG_DIR C:\Snort\log

# Step 4: Dynamic engine and rules (default)
dynamicengine C:\Snort\lib\snort_dynamicengine\sf_engine.dll
dynamicdetection directory C:\Snort\lib\snort_dynamicrules

# Step 5: Preprocessors (minimal set)
preprocessor stream5_global: track_tcp yes, track_udp yes
preprocessor stream5_tcp: policy first, use_static_footprint_sizes
preprocessor stream5_udp: ignore_any_rules
preprocessor stream5_icmp: ignore_any_rules
preprocessor frag3_global: max_frags 65536
preprocessor frag3_engine: policy first detect_anomalies
preprocessor http_inspect: global iis_unicode_map unicode.map 1252
preprocessor http_inspect_server: server default profile all ports { 80 8080 3128 }

# Step 6: Rules
include $RULE_PATH/local.rules
